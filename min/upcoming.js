(function(n,t){function c(n,t,i){this._d=n,this._isUTC=!!t,this._a=n._a||null,n._a=null,this._lang=i||!1}function w(n){var t=this._data={},o=n.years||n.y||0,r=n.months||n.M||0,c=n.weeks||n.w||0,i=n.days||n.d||0,u=n.hours||n.h||0,f=n.minutes||n.m||0,e=n.seconds||n.s||0,h=n.milliseconds||n.ms||0;this._milliseconds=h+e*1e3+f*6e4+u*36e5,this._days=i+c*7,this._months=r+o*12,t.milliseconds=h%1e3,e+=s(h/1e3),t.seconds=e%60,f+=s(e/60),t.minutes=f%60,u+=s(f/60),t.hours=u%24,i+=s(u/24),i+=c*7,t.days=i%30,r+=s(i/30),t.months=r%12,o+=s(r/12),t.years=o,this._lang=!1}function s(n){return n<0?Math.ceil(n):Math.floor(n)}function fi(n,t){for(var i=n+"";i.length<t;)i="0"+i;return i}function et(n,t,i){var r=t._milliseconds,u=t._days,f=t._months,e;r&&n._d.setTime(+n+r*i),u&&n.date(n.date()+u*i),f&&(e=n.date(),n.date(1).month(n.month()+f*i).date(Math.min(e,n.daysInMonth())))}function b(n){return Object.prototype.toString.call(n)==="[object Array]"}function ot(n,t){for(var u=Math.min(n.length,t.length),f=Math.abs(n.length-t.length),r=0,i=0;i<u;i++)~~n[i]!=~~t[i]&&r++;return r+f}function k(t,i){for(var r,u=1;u<7;u++)t[u]=t[u]==null?u===2?1:0:t[u];return t[7]=i,r=new n(0),i?(r.setUTCFullYear(t[0],t[1],t[2]),r.setUTCHours(t[3],t[4],t[5],t[6])):(r.setFullYear(t[0],t[1],t[2]),r.setHours(t[3],t[4],t[5],t[6])),r._a=t,r}function st(n,t){var r,u,f=[];for(!t&&g&&(t=require("./lang/"+n)),r=0;r<o.length;r++)t[o[r]]=t[o[r]]||e.en[o[r]];for(r=0;r<12;r++)u=i([2e3,r]),f[r]=new RegExp("^"+(t.months[r]||t.months(u,""))+"|^"+(t.monthsShort[r]||t.monthsShort(u,"")).replace(".",""),"i");return t.monthsParse=t.monthsParse||f,e[n]=t,t}function l(n){var t=typeof n=="string"&&n||n&&n._lang||null;return t?e[t]||st(t):i}function ei(n){return u[n]?"'+("+u[n]+")+'":n.replace(wt,"").replace(/\\?'/g,"\\'")}function oi(n){return l().longDateFormat[n]||n}function ht(n){var t="var a,b;return '"+n.replace(nt,ei)+"';",i=Function;return new i("t","v","o","p","m",t)}function ct(n,t){function r(r,u){return i[r].call?i[r](n,t):i[r][u]}for(var i=l(n);tt.test(t);)t=t.replace(tt,oi);return h[t]||(h[t]=ht(t)),h[t](n,r,i.ordinal,fi,i.meridiem)}function lt(n){switch(n){case"DDDD":return dt;case"YYYY":return gt;case"S":case"SS":case"SSS":case"DDD":return kt;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":case"a":case"A":return ni;case"Z":case"ZZ":return v;case"T":return ti;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return bt;default:return new RegExp(n.replace("\\",""))}}function si(n,t,i,r){var u;switch(n){case"M":case"MM":i[1]=t==null?0:~~t-1;break;case"MMM":case"MMMM":for(u=0;u<12;u++)if(l().monthsParse[u].test(t)){i[1]=u;break}break;case"D":case"DD":case"DDD":case"DDDD":t!=null&&(i[2]=~~t);break;case"YY":t=~~t,i[0]=t+(t>70?1900:2e3);break;case"YYYY":i[0]=~~Math.abs(t);break;case"a":case"A":r.isPm=(t+"").toLowerCase()==="pm";break;case"H":case"HH":case"h":case"hh":i[3]=~~t;break;case"m":case"mm":i[4]=~~t;break;case"s":case"ss":i[5]=~~t;break;case"S":case"SS":case"SSS":i[6]=~~(("0."+t)*1e3);break;case"Z":case"ZZ":r.isUTC=!0,u=(t+"").match(ui),u&&u[1]&&(r.tzh=~~u[1]),u&&u[2]&&(r.tzm=~~u[2]),u&&u[0]==="+"&&(r.tzh=-r.tzh,r.tzm=-r.tzm)}}function a(n,t){for(var i=[0,0,1,0,0,0,0],r={tzh:0,tzm:0},f=t.match(nt),e,u=0;u<f.length;u++)e=(lt(f[u]).exec(n)||[])[0],n=n.replace(lt(f[u]),""),si(f[u],e,i,r);return r.isPm&&i[3]<12&&(i[3]+=12),r.isPm===!1&&i[3]===12&&(i[3]=0),i[3]+=r.tzh,i[4]+=r.tzm,k(i,r.isUTC)}function hi(n,t){for(var f,s=n.match(it)||[],e,o=99,r,u,i=0;i<t.length;i++)r=a(n,t[i]),e=ct(new c(r),t[i]).match(it)||[],u=ot(s,e),u<o&&(o=u,f=r);return f}function ci(t){var r="YYYY-MM-DDT",i;if(ii.exec(t)){for(i=0;i<4;i++)if(rt[i][1].exec(t)){r+=rt[i][0];break}return v.exec(t)?a(t,r+" Z"):a(t,r)}return new n(t)}function li(n,t,i,r,u){var f=u.relativeTime[n];return typeof f=="function"?f(t||1,!!i,n,r):f.replace(/%d/i,t||1)}function ai(n,t,i){var s=f(Math.abs(n)/1e3),u=f(s/60),e=f(u/60),r=f(e/24),h=f(r/365),o=s<45&&["s",s]||u===1&&["m"]||u<45&&["mm",u]||e===1&&["h"]||e<22&&["hh",e]||r===1&&["d"]||r<=25&&["dd",r]||r<=45&&["M"]||r<345&&["MM",f(r/30)]||h===1&&["y"]||["yy",h];return o[2]=t,o[3]=n>0,o[4]=i,li.apply({},o)}function at(n,t){i.fn[n]=function(n){var i=this._isUTC?"UTC":"";return n!=null?(this._d["set"+i+t](n),this):this._d["get"+i+t]()}}function vi(n){i.duration.fn[n]=function(){return this._data[n]}}function vt(n,t){i.duration.fn["as"+n]=function(){return+this/t}}for(var i,yt="1.7.0",f=Math.round,r,e={},d="en",g=typeof module!="undefined"&&module.exports,o="months|monthsShort|weekdays|weekdaysShort|weekdaysMin|longDateFormat|calendar|relativeTime|ordinal|meridiem".split("|"),pt=/^\/?Date\((\-?\d+)/i,nt=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|zz?|ZZ?)/g,tt=/(LT|LL?L?L?)/g,wt=/(^\[)|(\\)|\]$/g,it=/([0-9a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)/gi,bt=/\d\d?/,kt=/\d{1,3}/,dt=/\d{3}/,gt=/\d{1,4}/,ni=/[0-9a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+/i,v=/Z|[\+\-]\d\d:?\d\d/i,ti=/T/i,ii=/^\s*\d{4}-\d\d-\d\d(T(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,ri="YYYY-MM-DDTHH:mm:ssZ",rt=[["HH:mm:ss.S",/T\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/T\d\d:\d\d:\d\d/],["HH:mm",/T\d\d:\d\d/],["HH",/T\d\d/]],ui=/([\+\-]|\d\d)/gi,y="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|"),p={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},h={},u={M:"(a=t.month()+1)",MMM:'v("monthsShort",t.month())',MMMM:'v("months",t.month())',D:"(a=t.date())",DDD:"(a=new Date(t.year(),t.month(),t.date()),b=new Date(t.year(),0,1),a=~~(((a-b)/864e5)+1.5))",d:"(a=t.day())",dd:'v("weekdaysMin",t.day())',ddd:'v("weekdaysShort",t.day())',dddd:'v("weekdays",t.day())',w:"(a=new Date(t.year(),t.month(),t.date()-t.day()+5),b=new Date(a.getFullYear(),0,4),a=~~((a-b)/864e5/7+1.5))",YY:"p(t.year()%100,2)",YYYY:"p(t.year(),4)",a:"m(t.hours(),t.minutes(),!0)",A:"m(t.hours(),t.minutes(),!1)",H:"t.hours()",h:"t.hours()%12||12",m:"t.minutes()",s:"t.seconds()",S:"~~(t.milliseconds()/100)",SS:"p(~~(t.milliseconds()/10),2)",SSS:"p(t.milliseconds(),3)",Z:'((a=-t.zone())<0?((a=-a),"-"):"+")+p(~~(a/60),2)+":"+p(~~a%60,2)',ZZ:'((a=-t.zone())<0?((a=-a),"-"):"+")+p(~~(10*a/6),4)'},ut="DDD w M D d".split(" "),ft="M D H h m s w".split(" ");ut.length;)r=ut.pop(),u[r+"o"]=u[r]+"+o(a)";while(ft.length)r=ft.pop(),u[r+r]="p("+u[r]+",2)";for(u.DDDD="p("+u.DDD+",3)",i=function(r,u){if(r===null||r==="")return null;var f,e;return i.isMoment(r)?new c(new n(+r._d),r._isUTC,r._lang):(u?f=b(u)?hi(r,u):a(r,u):(e=pt.exec(r),f=r===t?new n:e?new n(+e[1]):r instanceof n?r:b(r)?k(r):typeof r=="string"?ci(r):new n(r)),new c(f))},i.utc=function(n,t){return b(n)?new c(k(n,!0),!0):(typeof n!="string"||v.exec(n)||(n+=" +0000",t&&(t+=" Z")),i(n,t).utc())},i.unix=function(n){return i(n*1e3)},i.duration=function(n,t){var f=i.isDuration(n),e=typeof n=="number",r=f?n._data:e?{}:n,u;return e&&(t?r[t]=n:r.milliseconds=n),u=new w(r),f&&(u._lang=n._lang),u},i.humanizeDuration=function(n,t,r){return i.duration(n,t===!0?null:t).humanize(t===!0?!0:r)},i.version=yt,i.defaultFormat=ri,i.lang=function(n,t){var r;if(!n)return d;if((t||!e[n])&&st(n,t),e[n]){for(r=0;r<o.length;r++)i[o[r]]=e[n][o[r]];i.monthsParse=e[n].monthsParse,d=n}},i.langData=l,i.isMoment=function(n){return n instanceof c},i.isDuration=function(n){return n instanceof w},i.lang("en",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},meridiem:function(n,t,i){return n>11?i?"pm":"PM":i?"am":"AM"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(n){var t=n%10;return~~(n%100/10)==1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th"}}),i.fn=c.prototype={clone:function(){return i(this)},valueOf:function(){return+this._d},unix:function(){return Math.floor(+this._d/1e3)},toString:function(){return this._d.toString()},toDate:function(){return this._d},toArray:function(){var n=this;return[n.year(),n.month(),n.date(),n.hours(),n.minutes(),n.seconds(),n.milliseconds(),!!this._isUTC]},isValid:function(){return this._a?!ot(this._a,(this._a[7]?i.utc(this):this).toArray()):!isNaN(this._d.getTime())},utc:function(){return this._isUTC=!0,this},local:function(){return this._isUTC=!1,this},format:function(n){return ct(this,n?n:i.defaultFormat)},add:function(n,t){var r=t?i.duration(+t,n):i.duration(n);return et(this,r,1),this},subtract:function(n,t){var r=t?i.duration(+t,n):i.duration(n);return et(this,r,-1),this},diff:function(n,t,r){var e=this._isUTC?i(n).utc():i(n).local(),l=(this.zone()-e.zone())*6e4,u=this._d-e._d-l,s=this.year()-e.year(),h=this.month()-e.month(),c=this.date()-e.date(),o;return o=t==="months"?s*12+h+c/30:t==="years"?s+(h+c/30)/12:t==="seconds"?u/1e3:t==="minutes"?u/6e4:t==="hours"?u/36e5:t==="days"?u/864e5:t==="weeks"?u/6048e5:u,r?o:f(o)},from:function(n,t){return i.duration(this.diff(n)).lang(this._lang).humanize(!t)},fromNow:function(n){return this.from(i(),n)},calendar:function(){var n=this.diff(i().sod(),"days",!0),t=this.lang().calendar,u=t.sameElse,r=n<-6?u:n<-1?t.lastWeek:n<0?t.lastDay:n<1?t.sameDay:n<2?t.nextDay:n<7?t.nextWeek:u;return this.format(typeof r=="function"?r.apply(this):r)},isLeapYear:function(){var n=this.year();return n%4==0&&n%100!=0||n%400==0},isDST:function(){return this.zone()<i([this.year()]).zone()||this.zone()<i([this.year(),5]).zone()},day:function(n){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return n==null?t:this.add({d:n-t})},startOf:function(n){switch(n.replace(/s$/,"")){case"year":this.month(0);case"month":this.date(1);case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return this},endOf:function(n){return this.startOf(n).add(n.replace(/s?$/,"s"),1).subtract("ms",1)},sod:function(){return this.clone().startOf("day")},eod:function(){return this.clone().endOf("day")},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return i.utc([this.year(),this.month()+1,0]).date()},lang:function(n){return n===t?l(this):(this._lang=n,this)}},r=0;r<y.length;r++)at(y[r].toLowerCase(),y[r]);at("year","FullYear"),i.duration.fn=w.prototype={weeks:function(){return s(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*864e5+this._months*2592e6},humanize:function(n){var i=+this,r=this.lang().relativeTime,t=ai(i,!n,this.lang());return n&&(t=(i<=0?r.past:r.future).replace(/%s/i,t)),t},lang:i.fn.lang};for(r in p)p.hasOwnProperty(r)&&(vt(r,p[r]),vi(r.toLowerCase()));vt("Weeks",6048e5),g&&(module.exports=i),typeof ender=="undefined"&&(this.moment=i),typeof define=="function"&&define.amd&&define("moment",[],function(){return i})}).call(this,Date);var upcoming=function(){function w(){return function(){}}function e(n,t,i){dust.render(n,t,function(n,t){n!==null?f(n):i.innerHTML=t})}function k(){return b++}function l(){for(var t=arguments[0],i,n=0;n<arguments.length-1;n++)i=new RegExp("\\{"+n+"\\}","gm"),t=t.replace(i,arguments[n+1]);return t}function t(){f(l.apply(this,arguments))}function f(n){alert(n)}function d(o){var w,p,b;if(o===null){f(n.err_config_required);return}if(!et(o.id)){t(n.err_format_config_id_invalid,o.id);return}o=o||{id:null,evts:null,prog:null},o.evts=o.evts||{},o.prog=o.prog||{},o.prog.bdr=o.prog.bdr||{},o.prog.bar=o.prog.bar||{},o.prog.lbl=o.prog.lbl||{};var k=o.id||n.default_div_id,v=h[o.id]={id:k,max_results:o.max_results||5,expectedFeeds:[],ui:{div:null,css:o.css||"upcoming",prog:{id:k+(o.prog.idSuffix||"_prog"),div:null,css:o.prog.css||"prog",msgs:{},step:0,steps:0,bdr:{id:k+(o.prog.bdr.idSuffix||"_prog_bdr"),css:o.prog.bdr.css||"bdr",div:null},bar:{id:k+(o.prog.bar.idSuffix||"_prog_bar"),css:o.prog.bar.css||"bar",div:null},lbl:{id:k+(o.prog.lbl.idSuffix||"_prog_lbl"),css:o.prog.lbl.css||"lbl",div:null}},evts:{id:k+(o.prog.idSuffix||"_evts"),div:null,css:o.evts.css||"evts"}},evts:[],evtCats:ft(moment())},d=v.ui,y=v.ui.prog,nt=v.ui.evts;if(r(v,"init",n.prog_init),r(v,"sort",n.prog_sort),r(v,"render",n.prog_render),d.div=document.getElementById(v.id),d.div===null){t(n.err_format_cannot_render,v.id);return}if(d.div.setAttribute("class",d.css),e("upcoming_ui",d,d.div),y.div=document.getElementById(y.id),y.div===null){t(n.err_format_cannot_render,y.id);return}if(y.lbl.div=document.getElementById(y.lbl.id),y.lbl.div===null){t(n.err_format_cannot_render,y.lbl.id);return}if(y.bar.div=document.getElementById(y.bar.id),y.bar.div===null){t(n.err_format_cannot_render,y.bar.id);return}if(y.bdr.div=document.getElementById(y.bdr.id),y.bdr.div===null){t(n.err_format_cannot_render,y.bdr.id);return}if(nt.div=document.getElementById(nt.id),nt.div===null){t(n.err_format_cannot_render,nt.id);return}for(w=0;w<o.feeds.length;w++)p={id:o.feeds[w]+"_"+v.id,feed:o.feeds[w],instance:v.id,uri:"http://www.google.com/calendar/feeds/"+encodeURIComponent(o.feeds[w])+"/public/full"},v.expectedFeeds[p.uri]=p,r(v,p.id,l(n.prog_process_feed,w+1)),p.uri in i?(b=i[p.uri],b.expectedInstances[v.id]=p,b.data!==null&&a(null,p.uri)):(s++,b=i[p.uri]={data:null,expectedInstances:{},callback:"feed"+s},c[b.callback]=g(p.uri),b.expectedInstances[v.id]=p,document.write("<script type='text/javascript' src='"+p.uri+"?alt=json-in-script&callback=upcoming.callbacks."+encodeURIComponent(b.callback)+"&orderby=starttime&max-results="+encodeURIComponent(v.max_results)+"&singleevents=true&sortorder=ascending&futureevents=true'><\/script>"));u(v,"init")}function g(n){return function(t){a(t,n)}}function nt(n){var i,t={title:n.title.$t||null,where:n.gd$where[0].valueString||null,description:n.content.$t||null,startMoment:p(n.gd$when[0].startTime)||moment(),startTime:n.gd$when[0].startTime,endMoment:p(n.gd$when[0].endTime)||moment(n.startMoment),endTime:n.gd$when[0].endTime,createdBy:n.author[0].name.$t||null,id:k()};for(t.duration=moment.duration(t.endMoment.diff(t.startMoment)),t.whereHref=y(t.where)?t.where:"http://maps.google.com/maps?hl=en&q="+encodeURI(t.where),t.href=null,i=0;i<n.link.length;i++)n.link[i].type=="text/html"&&n.link[i].type=="alternate"&&(t.href=encodeURI(n.link[i].href));return t.titleHref=y(t.title)?t.title:t.href,t.when=t.duration.asMilliseconds()===0?t.startMoment.calendar():t.startMoment.calendar()+" - "+t.duration.humanize(),t}function tt(n){var i=[],t;if(n!==null)for(i[n.length-1]=null,t=0;t<n.length;t++)i[t]=nt(n[t]);return i}function a(n,t){var f=i[t],o,c,l,r,s,y,e,a,v;f.evts=f.evts||tt(n.feed.entry);for(a in f.expectedInstances){for(s=f.expectedInstances[a],r=h[s.instance],u(r,s.id),o=r.evts,c=o.length,l=f.evts.length,o[c+l-1]=null,e=0;e<l;e++)o[c+e]=f.evts[e];delete r.expectedFeeds[s.uri],delete f.expectedInstances[a];for(v in r.expectedFeeds)if(r.expectedFeeds.hasOwnProperty(v))return;rt(r),u(r,"render")}}function r(n,t,i){var r=n.ui.prog;r.msgs[t]=i,r.steps++}function u(n,t){var i=n.ui.prog,r;i.step===0&&(n.ui.prog.div.style.display="block"),r=i.msgs[t],i.step++,i.step>=i.steps?n.ui.prog.div.style.display="none":it(i,r,100*i.step/i.steps)}function it(n,t,i){i>=0?(n.bdr.div.style.display="block",n.bar.div.style.width=i+"%"):n.bdr.div.style.display="none",t!==null&&(n.lbl.div.innerHtml=t)}function rt(t){function l(n,t){return n.startMoment.diff(t.startMoment)}var o=t.evts,r,f,s,i,h,c;for(o.sort(l),r=t.evtCats,s=0,u(t,"sort"),i=0;i<o.length;i++)for(c=o[i],f=s;f<r.length;f++)if(h=r[f],ut(c,h)){s=i,h.evts.push(c);break}e("upcoming_evtcats",{res:n,evtCats:r},t.ui.evts.div)}function ut(n,t){if(t.start===null&&t.end===null)return!1;var i=t.start.diff(n.startMoment)<=0,r=t.end.diff(n.startMoment)>0;return i&&r}function v(n){return n.startMonth=n.start.format("MMM")+" ",n.endMonth=n.end.format("MMM")+" ",n.range=n.startMonth===n.endMonth?n.startMonth+n.start.format("Do")+" - "+n.end.format("Do"):n.startMonth+n.start.format("Do")+" - "+n.endMonth+n.end.format("Do"),n}function ft(t){var i=moment(t).sod(),c=moment(t).eod(),f=moment(i).subtract("days",i.day()),e=moment(f).add("weeks",1),o=moment(e),l=moment(o).add("week",1),r=moment(t).startOf("month"),s=moment(r).add("months",1),u=moment(s),a=moment(u).add("months",1),h=moment(t).startOf("year"),y=moment(t).endOf("year");return[{start:i,end:c,div:null,evts:[],dateFormat:n.time_format,timeFormat:n.time_format,multiDateFormat:n.date_format,caption:n.event_cat_today,range:i.format(n.date_format)},v({start:f,end:e,div:null,evts:[],dateFormat:n.date_format,timeFormat:n.time_format,multiDateFormat:n.date_format,caption:n.event_cat_this_week}),v({start:o,end:l,div:null,evts:[],dateFormat:n.date_format,timeFormat:n.time_format,multiDateFormat:n.date_format,caption:n.event_cat_next_week}),{start:r,end:s,div:null,evts:[],dateFormat:n.date_format,timeFormat:n.time_format,multiDateFormat:n.date_format,caption:n.event_cat_this_month,range:r.format("MMM YYYY")},{start:u,end:a,div:null,evts:[],dateFormat:n.date_format,timeFormat:n.time_format,multiDateFormat:n.date_format,caption:n.event_cat_next_month,range:u.format("MMM YYYY")},{start:h,end:y,div:null,evts:[],dateFormat:n.date_format,timeFormat:n.time_format,multiDateFormat:n.date_format,caption:n.event_cat_this_year,range:h.format("YYYY")},{start:null,end:null,div:null,evts:[],dateFormat:n.date_format,timeFormat:n.time_format,multiDateFormat:n.date_format,caption:n.event_cat_upcoming,range:""}]}function y(n){var t=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return t.test(n)}function et(n){var t=/[A-Za-z][A-Za-z0-9_:.]*/;return t.test(n)}function ot(n){var t,i;t=document.getElementById("evt_dtl_"+n),i=document.getElementById("evt_tgl_"+n),t.style.display=="none"?(t.style.display="block",i.innerHTML="&minus;"):t.style.display=="block"&&(t.style.display="none",i.innerHTML="+")}function p(n){function t(n){var t=i.match(new RegExp("^"+n));return t?(i=i.substring(t[0].length),t[0]):""}var i=n,f,e,o,c,r,l,u,a;if(typeof n=="undefined")return n;f=0,e=t("\\d{4}"),t("-?"),o=t("\\d{2}"),t("-?");var v=t("\\d{2}"),y=t("T"),s=0,h=0;return y=="T"&&(s=t("\\d{2}"),t(":?"),h=t("\\d{2}"),t("(:\\d{2})?(\\.\\d{3})?"),c=t("Z"),c!="Z"&&(r=t("[\\+\\-]"),r!==""&&(l=t("\\d{2}"),t(":?"),u=t("\\d{2}"),f=(r==="-"?1:-1)*(Number(l)*60+(u===""?0:Number(u)))))),a=new Date(e,o-1,v,s,h),moment(a)}window.console||function(){var t=["log","debug","info","warn","error","assert","dir","dirxml","group","groupEnd","time","timeEnd","count","trace","profile","profileEnd"],n;for(window.console={},n=0;n<t.length;++n)window.console[t[n]]=w()}();var o={},s=0,b=0,n={default_div_id:"upcoming",prog_init:"Initializing...",prog_process_feed:"Processing Feed {0}...",prog_sort:"Sorting Events...",prog_render:"Rendering Events...",prog_no_events_found:"No Events Found.",event_cat_today:"Today",event_cat_this_week:"This Week",event_cat_next_week:"Next Week",event_cat_this_month:"This Month",event_cat_next_month:"Next Month",event_cat_this_year:"This Year",event_cat_upcoming:"Upcoming",time_format:"LT",date_format:"LL",err_format_cannot_render:"Upcoming.js: Error. Cannot render to element '{0}'. Does this id exist?",err_format_config_id_invalid:"Upcoming.js: Error. Cannot render to element '{0}'. id not supported.",err_config_required:"Upcoming.js: Error. Cannot render without configuration.",last:"placeholder"};o.EN=o["EN-us"]=n;var h={},i={},c={};return{render:d,toggleEvtDetail:ot,callbacks:c}}();function getGlobal(){return function(){return this.dust}.call(null)}var dust={};(function(n){function i(n,t,i){this.stack=n,this.global=t,this.blocks=i}function u(t,i,r,u){this.tail=i,this.isObject=!n.isArray(t)&&t&&typeof t=="object",this.head=t,this.index=r,this.of=u}function f(n){this.head=new t(this),this.callback=n,this.out=""}function r(){this.head=new t(this)}function t(n,t,i){this.root=n,this.next=t,this.data="",this.flushable=!1,this.taps=i}function e(n,t){this.head=n,this.tail=t}n.cache={},n.register=function(t,i){t&&(n.cache[t]=i)},n.render=function(t,r,u){var e=new f(u).head;n.load(t,e,i.wrap(r)).end()},n.stream=function(t,u){var f=new r;return n.nextTick(function(){n.load(t,f.head,i.wrap(u)).end()}),f},n.renderSource=function(t,i,r){return n.compileFn(t)(i,r)},n.compileFn=function(t,u){var e=n.loadSource(n.compile(t,u));return function(t,u){var o=u?new f(u):new r;return n.nextTick(function(){e(o.head,i.wrap(t)).end()}),o}},n.load=function(t,i,r){var u=n.cache[t];return u?u(i,r):n.onLoad?i.map(function(i){n.onLoad(t,function(u,f){if(u)return i.setError(u);n.cache[t]||n.loadSource(n.compile(f,t)),n.cache[t](i,r).end()})}):i.setError(new Error("Template Not Found: "+t))},n.loadSource=function(n){return eval(n)},n.isArray=Array.isArray?Array.isArray:function(n){return Object.prototype.toString.call(n)=="[object Array]"},n.nextTick=function(){return typeof process!="undefined"?process.nextTick:function(n){setTimeout(n,0)}}(),n.isEmpty=function(t){return n.isArray(t)&&!t.length?!0:t===0?!1:!t},n.filter=function(t,i,r){var u,e,f;if(r)for(u=0,e=r.length;u<e;u++)f=r[u],f==="s"?i=null:t=n.filters[f](t);return i&&(t=n.filters[i](t)),t},n.filters={h:function(t){return n.escapeHtml(t)},j:function(t){return n.escapeJs(t)},u:encodeURI,uc:encodeURIComponent,js:function(n){return JSON?JSON.stringify(n):n},jp:function(n){return JSON?JSON.parse(n):n}},n.makeBase=function(n){return new i(new u,n)},i.wrap=function(n){return n instanceof i?n:new i(new u(n))},i.prototype.get=function(n){for(var t=this.stack,i;t;){if(t.isObject&&(i=t.head[n],!(i===undefined)))return i;t=t.tail}return this.global?this.global[n]:undefined},i.prototype.getPath=function(n,t){var i=this.stack,u=t.length,r;if(n&&u===0)return i.head;if(!i.isObject)return undefined;for(i=i.head,r=0;i&&r<u;)i=i[t[r]],r++;return i},i.prototype.push=function(n,t,r){return new i(new u(n,this.stack,t,r),this.global,this.blocks)},i.prototype.rebase=function(n){return new i(new u(n),this.global,this.blocks)},i.prototype.current=function(){return this.stack.head},i.prototype.getBlock=function(n,t,i){var r,u,f;if(typeof n=="function"&&(n=n(t,i).data,t.data=""),r=this.blocks,r)for(u=r.length;u--;)if(f=r[u][n],f)return f},i.prototype.shiftBlocks=function(n){var t=this.blocks;return n?(t?newBlocks=t.concat([n]):newBlocks=[n],new i(this.stack,this.global,newBlocks)):this},f.prototype.flush=function(){for(var n=this.head;n;){if(n.flushable)this.out+=n.data;else{if(n.error){this.callback(n.error),this.flush=function(){};return}return}n=n.next,this.head=n}this.callback(null,this.out)},r.prototype.flush=function(){for(var n=this.head;n;){if(n.flushable)this.emit("data",n.data);else{if(n.error){this.emit("error",n.error),this.flush=function(){};return}return}n=n.next,this.head=n}this.emit("end")},r.prototype.emit=function(n,t){var i,u,r,f;if(!this.events||(i=this.events[n],!i))return!1;if(typeof i=="function")i(t);else for(u=i.slice(0),r=0,f=u.length;r<f;r++)u[r](t)},r.prototype.on=function(n,t){return this.events||(this.events={}),this.events[n]?typeof this.events[n]=="function"?this.events[n]=[this.events[n],t]:this.events[n].push(t):this.events[n]=t,this},r.prototype.pipe=function(n){this.on("data",function(t){n.write(t,"utf8")}).on("end",function(){n.end()}).on("error",function(t){n.error(t)});return this},t.prototype.write=function(n){var t=this.taps;return t&&(n=t.go(n)),this.data+=n,this},t.prototype.end=function(n){return n&&this.write(n),this.flushable=!0,this.root.flush(),this},t.prototype.map=function(n){var i=new t(this.root,this.next,this.taps),r=new t(this.root,i,this.taps);return this.next=r,this.flushable=!0,n(r),i},t.prototype.tap=function(n){var t=this.taps;return this.taps=t?t.push(n):new e(n),this},t.prototype.untap=function(){return this.taps=this.taps.tail,this},t.prototype.render=function(n,t){return n(this,t)},t.prototype.reference=function(i,r,u,f){return typeof i=="function"&&(i.isReference=!0,i=i.apply(r.current(),[this,r,null,{auto:u,filters:f}]),i instanceof t)?i:n.isEmpty(i)?this:this.write(n.filter(i,u,f))},t.prototype.section=function(i,r,u,f){var e,c,h,o,s;if(typeof i=="function"&&(i=i.apply(r.current(),[this,r,u,f]),i instanceof t))return i;if(e=u.block,c=u["else"],f&&(r=r.push(f)),n.isArray(i)){if(e){for(h=i.length,o=this,r.stack.head.$len=h,s=0;s<h;s++)r.stack.head.$idx=s,o=e(o,r.push(i[s],s,h));return r.stack.head.$idx=undefined,r.stack.head.$len=undefined,o}}else if(i===!0){if(e)return e(this,r)}else if(i||i===0){if(e)return r.stack.head.$idx=0,r.stack.head.$len=1,o=e(this,r.push(i)),r.stack.head.$idx=undefined,r.stack.head.$len=undefined,o}else if(c)return c(this,r);return this},t.prototype.exists=function(t,i,r){var u=r.block,f=r["else"];if(n.isEmpty(t)){if(f)return f(this,i)}else if(u)return u(this,i);return this},t.prototype.notexists=function(t,i,r){var u=r.block,f=r["else"];if(n.isEmpty(t)){if(u)return u(this,i)}else if(f)return f(this,i);return this},t.prototype.block=function(n,t,i){var r=i.block;return(n&&(r=n),r)?r(this,t):this},t.prototype.partial=function(t,i,r){var u=i.stack,f=u.head;return(r&&(i=i.rebase(u.tail),i=i.push(r),i=i.push(f)),typeof t=="function")?this.capture(t,i,function(t,r){n.load(t,r,i).end()}):n.load(t,this,i)},t.prototype.helper=function(t,i,r,u){return n.helpers[t](this,i,r,u)},t.prototype.capture=function(n,t,i){return this.map(function(r){var u=new f(function(n,t){n?r.setError(n):i(t,r)});n(u.head,t).end()})},t.prototype.setError=function(n){return this.error=n,this.root.flush(),this},e.prototype.push=function(n){return new e(n,this)},e.prototype.go=function(n){for(var t=this;t;)n=t.head(n),t=t.tail;return n};var o=new RegExp(/[&<>\"\']/),s=/&/g,h=/</g,c=/>/g,l=/\"/g,a=/\'/g;n.escapeHtml=function(n){return typeof n=="string"?o.test(n)?n.replace(s,"&amp;").replace(h,"&lt;").replace(c,"&gt;").replace(l,"&quot;").replace(a,"&#39;"):n:n};var v=/\\/g,y=/\r/g,p=/\u2028/g,w=/\u2029/g,b=/\n/g,k=/\f/g,d=/'/g,g=/"/g,nt=/\t/g;n.escapeJs=function(n){return typeof n=="string"?n.replace(v,"\\\\").replace(g,'\\"').replace(d,"\\'").replace(y,"\\r").replace(p,"\\u2028").replace(w,"\\u2029").replace(b,"\\n").replace(k,"\\f").replace(nt,"\\t"):n}})(dust),typeof exports!="undefined"&&(dust.helpers=require("./dust-helpers").helpers,typeof process!="undefined"&&require("./server")(dust),module.exports=dust),function(n){function u(n){var t=n.current();return typeof t=="object"&&t.isSelect===!0}function t(n,t,i,e,o){var e=e||{},s,h;if(e.key)s=r.tap(e.key,n,t);else if(u(t))s=t.current().selectKey,t.current().isResolved&&(o=function(){return!1});else throw"No key specified for filter and no key found in context from select statement";return(h=r.tap(e.value,n,t),o(h,f(s,e.type,t)))?(u(t)&&(t.current().isResolved=!0),n.render(i.block,t)):i["else"]?n.render(i["else"],t):n.write("")}function f(n,t,i){if(n)switch(t||typeof n){case"number":return+n;case"string":return String(n);case"boolean":return Boolean(n);case"date":return new Date(n);case"context":return i.get(n)}return n}var i=typeof console!="undefined"?console:{log:function(){}},r={sep:function(n,t,i){return t.stack.index===t.stack.of-1?n:i.block(n,t)},idx:function(n,t,i){return i.block(n,t.push(t.stack.index))},contextDump:function(n,t){return i.log(JSON.stringify(t.stack)),n},tap:function(n,t,i){var r=n;return typeof n=="function"&&(typeof n.isReference!="undefined"&&n.isReference===!0?r=n():(r="",t.tap(function(n){return r+=n,""}).render(n,i).untap(),r===""&&(r=!1))),r},"if":function(n,t,r,u){if(u&&u.cond){var f=u.cond;if(f=this.tap(f,n,t),eval(f))return n.render(r.block,t);if(r["else"])return n.render(r["else"],t)}else i.log("No condition given in the if helper!");return n},select:function(n,t,r,u){if(u&&u.key){var f=this.tap(u.key,n,t);return n.render(r.block,t.push({isSelect:!0,isResolved:!1,selectKey:f}))}return i.log("No key given in the select helper!"),n},eq:function(n,i,r,u){return t(n,i,r,u,function(n,t){return t===n})},lt:function(n,i,r,u){return t(n,i,r,u,function(n,t){return t<n})},lte:function(n,i,r,u){return t(n,i,r,u,function(n,t){return t<=n})},gt:function(n,i,r,u){return t(n,i,r,u,function(n,t){return t>n})},gte:function(n,i,r,u){return t(n,i,r,u,function(n,t){return t>=n})},"default":function(n,i,r,u){return t(n,i,r,u,function(){return!0})},size:function(t,i,r,u){var f=u.subject,e=0,o,s;if(f)if(n.isArray(f))e=f.length;else if(isNaN(f))if(Object(f)===f){o=0;for(s in f)Object.hasOwnProperty.call(f,s)&&o++;e=o}else e=(f+"").length;else e=f;else e=0;return t.write(e)}};n.helpers=r}(typeof exports!="undefined"?exports:getGlobal());(function(){function n(n,t){return n.write('<div class="').reference(t.getPath(!1,["prog","css"]),t,"h").write('" id="').reference(t.getPath(!1,["prog","id"]),t,"h").write('"><span class="').reference(t.getPath(!1,["prog","lbl","css"]),t,"h").write('" id="').reference(t.getPath(!1,["prog","lbl","id"]),t,"h").write('" style="display: none;">&nbsp;<\/span><div class="').reference(t.getPath(!1,["prog","bdr","css"]),t,"h").write('" id="').reference(t.getPath(!1,["prog","bdr","id"]),t,"h").write('" style="display: none;"><div class="').reference(t.getPath(!1,["prog","bar","css"]),t,"h").write('" style="width: 0px;" id="').reference(t.getPath(!1,["prog","bar","id"]),t,"h").write('"><\/div><\/div><\/div><div class="').reference(t.getPath(!1,["evts","css"]),t,"h").write('" id="').reference(t.getPath(!1,["evts","id"]),t,"h").write('"><\/div>')}return dust.register("upcoming_ui",n),n})();(function(){function n(n,i){return n.section(i.get("evtCats"),i,{block:t},null)}function t(n,t){return n.write(" ").exists(t.get("evts"),t,{"else":i,block:r},null)}function i(n,t){return n.reference(t.getPath(!1,["res","no_events"]),t,"h")}function r(n,t){return n.write(' <div class="evtcat"><span class="caption">').reference(t.get("caption"),t,"h").write('<\/span><span class="range">').reference(t.get("range"),t,"h").write('<\/span><div class="evts">').section(t.get("evts"),t,{block:u},null).write("<\/div><\/div>")}function u(n,t){return n.write('<div class="evt"><span class="toggle" id="evt_tgl_').reference(t.get("id"),t,"h").write('" onclick="upcoming.toggleEvtDetail(').reference(t.get("id"),t,"h").write(');">+<\/span><span class="title">').exists(t.get("titleHref"),t,{"else":f,block:e},null).write('<\/span><div class="detail" id="evt_dtl_').reference(t.get("id"),t,"h").write('" style="display:none;"><strong class="when">When<\/strong><span class="when">').reference(t.get("when"),t,"h").write('<\/span><br /><strong class="where">Where<\/strong><span class="where">').exists(t.get("whereHref"),t,{"else":o,block:s},null).write('<\/span><br /><strong class="createdBy">Created by<\/strong><span class="createdBy">').reference(t.get("createdBy"),t,"h").write('<\/span><br /><strong class="description">Description<\/strong><span class="description">').reference(t.get("description"),t,"h").write("<\/span><\/div><\/div>")}function f(n,t){return n.reference(t.get("title"),t,"h")}function e(n,t){return n.write('<a href="').reference(t.get("titleHref"),t,"h").write('">').reference(t.get("title"),t,"h").write("<\/a>")}function o(n,t){return n.reference(t.get("where"),t,"h")}function s(n,t){return n.write('<a href="').reference(t.get("whereHref"),t,"h").write('">').reference(t.get("where"),t,"h").write("<\/a>")}return dust.register("upcoming_evtcats",n),n})()